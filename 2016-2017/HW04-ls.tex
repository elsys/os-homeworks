\documentclass[a4paper,10pt]{article}
%\usepackage{beamerarticle}

\input{../problems.tex}


\begin{document}


\ostitlepage{Задача 4: Реализация на {\ttfamily ls}}


\section{Условие на задачата}
\subsection{Основна функционалност (20 точки)}

Целта на задачате е да се реализира стандартната \lstinline{UNIX} комадна \lstinline{ls} с добавена функционалност.

Командата \lstinline{ls} се използва за извеждане на съдържанието на директории. От командния ред програмата получава списък от имена на файлове и/или директории, а на стандартния изход извежда информация за тях. Ако подаденото име, е съществуващ файл, се извежда името му и неговия тип, а ако името е на директория - имената и типовете на всички файлове, съдържащи се в директорията.

Прието е типовете на файловете в POSIX да се означават по следния начин:
\begin{itemize}
	\item обикновен файл - '-'
	\item директория - 'd'
	\item блоково устройство - 'b'
	\item символно устройство - 'c'
	\item програмен поток - 'p'
	\item символна връзка - 'l'
	\item сокет - 's'
\end{itemize}

Примерен изход на програмата:
\begin{verbatim}
$ ls a.txt 
- a.txt
$ ls /usr/share/texmf/tex 
- fontinst  
- generic  
d latex
\end{verbatim}

\textbf{Забележка}: \lstinline{ls} не показва скрити файлове.\newline

В случай на повече от един аргумент изходът изглежда по следния начин:
\begin{verbatim}
$ ls a.txt b.txt /usr/share/texmf/tex /usr/share/texmf/metapost/
- a.txt
- b.txt

/usr/share/texmf/metapost/:
- metauml

/usr/share/texmf/tex:
- fontinst
- generic
d latex
\end{verbatim}

\subsection{Поддръжка на {\ttfamily -A} (20 точки)}
Командата \lstinline{ls} трябва да поддържа незадължителния аргумент \lstinline{-A}.

При използване на опцията \lstinline{-A} командата трябва да извежда и скритите файлове без ".." и ".". Например:
\begin{verbatim}
$ ls -A
- a.out
- a.txt
- b.txt
d forbidden
- .hidden
- main.c
\end{verbatim}

\subsection{Поддръжка на {\ttfamily -l} (20 точки)}
Командата \lstinline{ls} трябва да поддържа незадължителния аргумент \lstinline{-l}.

При използване на опцията \lstinline{-l} командата трябва да извежда подробна информация за файловете. Например:
\begin{verbatim}
$ ls -l
total 28
-rwxrwxr-x 1 hristo hristo 8510 май 31 01:56 a.out
-rw-rw-r-- 1 hristo hristo   13 май 31 01:51 a.txt
-rw-rw-r-- 1 hristo hristo   27 май 31 01:51 b.txt
d--------- 2 hristo hristo 4096 май 31 01:54 forbidden
-rw-rw-r-- 1 hristo hristo   72 май 31 01:51 main.c
\end{verbatim}

\subsection{Поддръжка на {\ttfamily -R} (20 точки)}
Командата \lstinline{ls} трябва да поддържа незадължителния аргумент \lstinline{-R}.

При използване на опцията \lstinline{-R} командата трябва при обработване на директории да ги обхожда рекурсивно. При примерна файлова структура:
\begin{verbatim}
.
|-- a.out
|-- a.txt
|-- b.txt
|-- dir1
|  |-- dir11
|  |-- file01.txt
|-- dir2
|-- dir3
\end{verbatim}
резултатът от изпълнението на програмата трябва да е:
\begin{verbatim}
$ ls -R

.:
- a.out
- a.txt
- b.txt
d dir1
d dir2
d dir3

./dir1:
d dir11
- file01.txt

./dir1/dir11:

./dir2:

./dir3:

\end{verbatim}

\subsection{Комбинация от опции}
Възможна е произволна комбинация от опции. Например: ls -lRА, ls -Аl, ..

\subsection{Обработка на грешки (20 точки)}

Ако някой от аргументите на \lstinline{ls} не е файл или директория, то програмата трябва да изведе съобщение на стандартната грешка (\lstinline{stderr}). Например, ако бъдат предадени аргументи, които не са файлове, то
съобщението трябва да бъде оформено по следния начин:
\begin{verbatim}
$ ls aa
ls: cannot access 'aa': No such file or directory
\end{verbatim}

Ако на програмата се предаде име на директория, която потребителят няма права да отвори, то
съобщението трябва да бъде оформено по следния начин:
\begin{verbatim}
$ ls forbidden/
ls: cannot open directory 'forbidden/': Permission denied
\end{verbatim}

\color{white}


\subsection{Поддръжка на специален файл Христо}
Ако името на файл или директория е ``hristo'', то до него трябва да се изведе усмихнато човече ``(:''


\color{black}

\section{Изисквания към решението и оценяване}
\begin{enumerate}

\item Решението на задачата трябва да бъде написано на езика \lstinline{C} съгласно ISO/IEC 9899:1999.

\item Правилата за оценяване са следните. Приемаме, че напълно коректна и написана спрямо изискванията програма получава максималния брой точки — $100\%$ или 70 точки. Ако в решението има пропуски, максималният брой точки ще бъде намален съгласно правилата описани по-долу.

\item Задължително към файловете с решението трябва да е приложен и \lstinline{Makefile}. Изпълнимият файл, който се създава по време на компилация на решението, трябва да се казва \lstinline{ls}.

\item При проверка на решението програмата ви ще бъде компилирана и тествана по следния начин:
\begin{lstlisting}
make
./ls .
\end{lstlisting}
Предходната процедура ще бъде изпълнена няколко пъти с различни входни данни за да се провери дали вашата програма работи коректно.

\item Реализацията на програмата трябва да спазва точно изискванията. Всяко отклонение от изискванията ще доведе до получаване на 0 точки за съответната част от условието.

\item Работи, които са предадени по-късно от обявеното (или не са предадени), ще бъдат оценени с 0 точки.


\item Програмата ви трябва да съдържа достатъчно коментари. Оценката на решения без коментари или с недостатъчно и/или мъгляви коментари ще бъде намалена с $30\%$.

\item Всеки файл от решението трябва да започва със следният коментар:
\begin{verbatim}
//--------------------------------------------
// NAME: Ivan Ivanov
// CLASS: XIa
// NUMBER: 13
// PROBLEM: #1
// FILE NAME: xxxxxx.yyy.zzz (unix file name)
// FILE PURPOSE:
// 	няколко реда, които описват накратко
// 	предназначението на файла
// 	...
//--------------------------------------------- 
\end{verbatim}
Всяка функция във вашата програма трябва да включва кратко описание в следния формат:
\begin{verbatim}
//--------------------------------------------
// FUNCTION: xxyyzz (име на функцията)
// 	предназначение на функцията
// PARAMETERS:
// 	списък с параметрите на функцията
// 	и тяхното значение
//----------------------------------------------
\end{verbatim}

\item Лош стил на програмиране и липсващи заглавни коментари ще ви костват $30\%$.

\item Програми, които не се компилират получават 0 точки. Под „не се компилират“ се има предвид произволна причина, която може да причини неуспешна компилация, включително липсващи файлове, неправилни имена на файлове, синтактични грешки, неправилен или липсващ  \lstinline{Makefile}, и т.н. Обърнете внимание, че в \lstinline{UNIX} имената на файловете са ``case sensitive''.

\item Програми, които се компилират, но не работят, не могат да получат повече от $50\%$. Под „компилира се, но не работи“ се има предвид, че вие сте се опитали да решите проблема до известна степен, но не сте успели да направите пълно решение. Често срещан проблем, който спада към този случай, е че вашият  Makefile генерира изпълним файл, но той е именуван с име, различно от очакваното (т.е. \lstinline{ls} в разглеждания случай).

\item Безсмислени или мъгляви програми ще бъдат оценявани с 0 точки, независимо че се компилират. 

\item Програми, които дават неправилни или непълни резултати, или програми, в които изходът и/или форматирането се различава от изискванията ще получат не повече от $70\%$.

\item Всички наказателни точки се сумират. Например, ако вашата програма няма задължителните коментари в началото на файлове и функциите се отнемат $30\%$, ако няма достатъчно коментари се отнемат още $30\%$, компилира се, но не работи правилно — още $30\%$, то тогава резултатът ще бъде: 
$70*(100-30-30-30)\%= 70*10\%= 7$ точки

\item Работете самостоятелно. Групи от работи, които имат твърде много прилики една с друга, ще бъдат оценявани с 0 точки.

\end{enumerate}

\end{document}
