\documentclass[a4paper,10pt]{article}
%\usepackage{beamerarticle}

\input{../problems.tex}

\begin{document}

	\ostitlepage{Задача 3: Реализация на прототип на StarCraft III}
	
	\section{Условие на задачата}
	
		\subsection{Основна функционалност (50 точки)}

			Студиото за разработка на игри Blizzard Entertainment има нужда от помощ в разработването на прототип на следваща игра от поредицата StarCraft. Подобно на предишните версии на играта, когато играта стартира, играчът разполага с 5 работници (SCV), Команден център (Command center) и 0 минерали. Целта на играча е да построи 20 войника. Войниците струват минерали, които се набавят с помощта на работници. Броят на минералните блокове се подава като аргумент при стартирането на играта. Играта приключва след като се изкопаят всички минерални блокове на картата и се построят 20 войника. Играчът подава команди на стандартния вход. Целта на задачата е да се реализира синхронизация на нишки посредством \verb|mutex|-и.

			\subsubsection{Работници}
				Работниците служат за добиване на минерали. Изпълняват следната поредица от действия:
				\begin{enumerate}
					\item Придвижване до непразен минерален блок (симулира се време, 3s).
						\subitem {\footnotesize Всеки работник локално пази информация кои минерални блокове са празни.}
					\item Проверка дали минералния блок е свободен (не се симулира допълнително време)
						\subitem {\footnotesize Ако не е свободен, работникът се предвижва до следващия непразен минерален блок, което отново се симулира с време.}
					\item Копаене на минерали (не се симулира допълнително време).
						\subitem {\footnotesize Преди започването на копаене на стандартния изход трябва да се изведе съобщението - ``SCV N is mining from mineral block M'', където N е поредния номер на работника, а M - поредния номер на минералния блок.}
					\item Транспортиране на минералите до Командния център (симулира се време, 2s).
						\subitem {\footnotesize При стартиране на транспортирането трябва да се изведе - ``SCV N is transporting minerals''.}
					\item Разтоварване на минералите (не се симулира допълнително време).
						\subitem {\footnotesize След успешно разтоварване трябва да се изведе - ``SCV N delivered minerals to the Command center''.}
					\item (Връщане на стъпка 1).
				\end{enumerate}
				При всяко копаене се добиват 8 минерала. Всеки работник трябва да се изпълнява в отделна нишка. При изчерпване на минералите на картата нишките на работниците трябва да прекратят изпълнението си.
			
			\subsubsection{Команден център}
				Командният център служи за обучение на войници и като място за разтоварване на минерали. Обучението на войници не пречи на разтоварването на минерали. Изисквания:
				\begin{itemize}
					\item В Командния център трябва да може да се разтоварват минерали и да се обучават войници едновременно.
					\item Само по един работник може да разтоварва минерали в Командния център по едно и също време.
				\end{itemize}
				Обучаването на войник струва 50 минерала и се симулира време за обучение 1s. След обучението на войник трябва да се изведе съобщението ``You wanna piece of me, boy?''.

			\subsubsection{Команди подавани от играча}
			Командите се подават от играча на стандартния вход. Възможните команди са:
			\begin{itemize}
				\item ``m'' за да се построи нов войник.
			\end{itemize}
			
			\subsubsection{Общи}
			\begin{itemize}
				\item Първоначалният брой минерални блокове е 2 (ако не е подаден аргумент на програмата).
				\item Всеки минерален блок съдържа 500 минерала.
				\item Общият брой работници и войници не може да надвишава 200.
				\item Всички нишки трябва да работят паралелно една спрямо друга.
				\item Синхронизацията между отделните нишки трябва да става посредством \verb|mutex|-и.
				\item Симулирането на време става чрез използването на \verb|sleep()|.
				\item Не е нужно да се следи за ситуации, в които играчът не може да завърши успешно играта.
			\end{itemize}
			
			При приключване на играта трябва да се изведе броя на първоначалните минерали на картата, общите събрани минерали от играча, броя на работници и броя на войници (Пример: "Map minerals N, mined minerals M, SCVs X, Marines Y\n", където N, M, X, Y са броя на съответните ресурси). При правилно решение на задачата, събраните минерали ВИНАГИ ще са равни на първоначалните минерали на картата.
			
			\subsubsection{Примерна игра}
				\begin{verbatim}
SCV 1 is mining from mineral block 1
SCV 1 is transporting minerals
SCV 1 delivered minerals to the Command Center
SCV 2 is mining from mineral block 2
SCV 2 is transporting minerals
SCV 2 delivered minerals to the Command Center
SCV 3 is mining from mineral block 1
SCV 3 is transporting minerals
SCV 3 delivered minerals to the Command Center
SCV 4 is mining from mineral block 2
SCV 4 is transporting minerals
SCV 4 delivered minerals to the Command Center
m
Not enough minerals.
SCV 5 is mining from mineral block 2
SCV 5 is transporting minerals
SCV 5 delivered minerals to the Command Center
SCV 1 is mining from mineral block 1
SCV 1 is transporting minerals
SCV 1 delivered minerals to the Command Center
SCV 2 is mining from mineral block 2
SCV 2 is transporting minerals
SCV 2 delivered minerals to the Command Center
m
You wanna piece of me, boy?
...
Map minerals 2000, mined minerals 2000, SCVs 5, Marines 20
\end{verbatim}
	
		\subsection{Поддръжка на N на брой работници (25 точки)}
		
			Играчът има възможност да обучава работници от Командния център, чрез въвеждане на команда ``s'' на стандартния вход. Цената на един работник е 50 минерала и времето за обучение е 4s. След обучението на работник трябва да се извежда съобщението ``SCV good to go, sir.''.
			
			\begin{verbatim}
...
SCV 1 is mining from mineral block 1
SCV 1 is transporting minerals 
SCV 1 delivered minerals to the Command Center
s
SCV 1 is mining from mineral block 2
SCV 1 is transporting minerals
SCV good to go, sir.
SCV 2 is mining from mineral block 3
SCV 2 is transporting minerals
SCV 1 delivered minerals to the Command Center
SCV 2 delivered minerals to the Command Center
...
\end{verbatim}
		\subsection{Обработка на грешки (25 точки)}
		\begin{itemize}
			\item При логически грешки от страна на играча трябва да се изведе съобщение за грешка и играта да се продължи. Пример за логическа грешка е строенето на войник, когато няма достатъчно събрани минерали.
			\item Ако при извикване на pthread\_create, pthread\_mutex\_init, и т.н. възникне грешка, трябва да се изведе съобщение за грешка и програмата да се прекрати.
		\end{itemize}

	\section{Изисквания към решението и оценяване}
	
		\begin{enumerate}
			\item Програмата трябва да бъде написана на езика \verb|C| съгласно ISO/IEC 9899:1999.

			\item Правилата за оценяване са следните. Приемаме, че напълно коректна и написана спрямо изискванията програма 
			получава максималния брой точки — $100\%$ или 100 точки. Ако в решението има пропуски, максималният брой точки ще 
			бъде намален съгласно правилата описани по-долу.

			\item За работа с нишки трябва да се използва семейството от функции \verb|pthread_create()|, \verb|pthread_mutex_init()|, и т.н. \item Задължително към файловете с решението трябва да е приложен и
			\verb|Makefile|. Изпълнимият файл, който се създава по време на компилация на решението, трябва да се казва
			\verb|starcraft3|.

			\item При проверка на решението програмата ви ще бъде компилирани и тествана по следния начин:
				\begin{lstlisting}[language=bash]
make
./starcraft3 10
				\end{lstlisting}
				
				Предходната процедура ще бъде изпълнена няколко пъти с различни входни данни за да се провери дали вашата програма работи коректно. Също така програмата трябва да продължи да работи коректно, ако се изпуснат всички извиквания към \verb|sleep()|.

			\item Реализацията на програмата трябва да спазва точно изискванията описани по-горе. Всяко отклонение от 
			изискванията ще доведе до получаване на 0 точки за съответната част от условието.
			
			\item Работи, които са предадени по-късно от обявеното (или не са предадени), ще бъдат оценени с 0 точки.
			
			\item Програмата ви трябва да съдържа достатъчно коментари. Оценката на решения без коментари или с недостатъчно 
			и/или мъгляви коментари ще бъде намалена с $30\%$.
			
			\item Всеки файл от решението трябва да започва със следният коментар:

				\begin{verbatim}
//--------------------------------------------
// NAME: Ivan Ivanov
// CLASS: Xia
// NUMBER: 13
// PROBLEM: #3
// FILE NAME: xxxxxx.yyy.zzz (unix file name)
// FILE PURPOSE:
// 	няколко реда, които описват накратко
// 	предназначението на файла
// 	...
//--------------------------------------------- 
				\end{verbatim}
	
				Всяка функция във вашата програма трябва да включва кратко описание в следния формат:

				\begin{verbatim}
//--------------------------------------------
// FUNCTION: xxyyzz (име на функцията)
// 	предназначение на функцията
// PARAMETERS:
// 	списък с параметрите на функцията
// 	и тяхното значение
//----------------------------------------------
				\end{verbatim}

			\item Лош стил на програмиране и липсващи заглавни коментари ще ви костват $30\%$.
			
			\item Програми, които не се компилират получават 0 точки. Под „не се компилират“ се има предвид произволна причина, 
			която може да причини неуспешна компилация, включително липсващи файлове, неправилни имена на файлове, синтактични 
			грешки, неправилен или липсващ  \verb|Makefile|, и т.н. Обърнете внимание, че в \verb|UNIX| имената на файловете 
			са case sensitive.
			
			\item Програми, които се компилират, но не работят, не могат да получат повече от $50\%$. Под „компилира се, но не 
			работи“ се има предвид, че вие сте се опитали да решите проблема до известна степен, но не сте успели да направите 
			пълно решение. Често срещан проблем, който спада към този случай, е че вашият  Makefile генерира изпълним файл, но 
			той е именуван с име, различно от очакваното (т.е. \verb|head| в разглеждания случай).
			
			\item Безсмислени или мъгляви програми ще бъдат оценявани с 0 точки, независимо че се компилират.
			
			\item Програми, които дават неправилни или непълни резултати, или програми, в които изходът и/или форматирането се 
			различава от изискванията ще получат не повече от $70\%$.
			
			\item Всички наказателни точки се сумират. Например, ако вашата програма няма задължителните коментари в началото 
			на файлове и функциите се отнемат $30\%$, ако няма достатъчно коментари се отнемат още $30\%$, компилира се, но не 
			работи правилно — още $30\%$, то тогава резултатът ще бъде: $50*(100-30-30-30)\%= 50*10\%= 5$ точки
			
			\item Работете самостоятелно. Групи от работи, които имат твърде много прилики една с друга, ще бъдат оценявани с 				0 точки.
			
		\end{enumerate}

\end{document}
